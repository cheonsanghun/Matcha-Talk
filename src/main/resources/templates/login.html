<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>로그인 테스트</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { max-width: 560px; margin: 24px auto; font-family: system-ui, sans-serif; line-height: 1.5; }
    label { display:block; margin-top: 10px; font-weight: 600; }
    input { width: 100%; padding: 10px; margin-top: 6px; box-sizing: border-box; }
    button { margin-top: 16px; padding: 10px 14px; cursor: pointer; }
    .msg { margin-top: 12px; white-space: pre-wrap; }
    code { display: block; padding: 10px; background: #f4f4f4; overflow-x: auto; }
  </style>
</head>
<body>
<h1>로그인 테스트 폼</h1>

<form id="loginForm">
  <label>로그인 ID
    <input id="loginId" required placeholder="회원가입 때 사용한 ID" />
  </label>

  <label>비밀번호
    <input id="password" type="password" required placeholder="회원가입 때 사용한 비번" />
  </label>

  <button type="submit">로그인 요청 보내기</button>
</form>

<div class="msg" id="msg"></div>
<h3>발급받은 토큰</h3>
<code id="tokenBox">(토큰이 여기에 표시됩니다)</code>

<script>
  // API 엔드포인트 URL (백엔드에서 컨트롤러 만들면 해당 경로로 맞추세요)
  const LOGIN_URL = '/api/auth/login';

  document.getElementById('loginForm').addEventListener('submit', async (e) => {
    e.preventDefault();

    const payload = {
      loginId : document.getElementById('loginId').value.trim(),
      password: document.getElementById('password').value
    };

    try {
      const res = await fetch(LOGIN_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload),
      });

      const text = await res.text();
      document.getElementById('msg').textContent = `[HTTP ${res.status}] ${text}`;

      // 성공 시 JSON 형태라면 {accessToken: "..."} 가정하고 파싱 시도
      try {
        const json = JSON.parse(text);
        if (json.accessToken) {
          document.getElementById('tokenBox').textContent = json.accessToken;
          // 이후 보호 API 테스트 시:
          // fetch('/api/users/me', { headers: { Authorization: 'Bearer ' + json.accessToken }})
        }
      } catch(e) {
        // 응답이 JSON이 아니면 그대로 표시
      }
    } catch (err) {
      document.getElementById('msg').textContent = '요청 실패: ' + err;
    }
  });
</script>
</body>
</html>
